<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="utf-8">
  <title>Raby Lab</title>
  <meta name="description" content="ミニディスプレイでシューティングゲームを作る">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" href="img/header/Rabbit.png">
  <link rel="stylesheet" href="https://unpkg.com/ress/dist/ress.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.9.0/slick.min.css">
  <link rel="stylesheet" href="css/index.css">
  <link rel="stylesheet" href="css/product.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.9.0/slick.min.js"></script>
  <script src="js/main.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js"></script>
  <script>
    // ハイライトを実行
    hljs.initHighlightingOnLoad();
  </script>
</head>

<body>
  <header id="header">
    <h1 class="site-title">
      <a href="index.html"><img src="img/header/RABY_LAB.png" alt="Sneakers"></a>
    </h1>

    <nav id="navi">
      <ul class="nav-menu">
        <li><a href="index.html">COLLECTION OF WORKS</a></li>
        <li><a href="#contact">CONTACT</a></li>
        <li><a href="self-introduction1.html">INTRODUCTION</a></li>
        <li><a href="about.html">ABOUT</a></li>
        <li><a href="company.html">COMPANY</a></li>
      </ul>
      <ul class="nav-sns">
        <li><a href="https://twitter.com/" target="_blank">Twitter</a></li>
        <li><a href="https://www.facebook.com/" target="_blank">facebook</a></li>
        <li><a href="https://www.instagram.com/" target="_blank">instagram</a></li>
      </ul>
    </nav>

    <div class="toggle_btn">
      <span></span>
      <span></span>
      <span></span>
    </div>

    <div id="mask"></div>
  </header>

  <main id="main">
    <!-- 作った作品のプログラミング詳細 -->
    <section id="explanation">
      <h2 class="sec-title">ミニディスプレイでシューティングゲームを作る</h2>
      <section class="centered-section">
        <img class="title_img" src="img/product6_img/product6.png" alt="">
      </section>
      <section class="centered-section">
        <h3 class="ther-title">1.OVERVIEW</h3>
        <p class="overview-text">
          皆さんはインベーダーゲームを御存じでしょうか。<br>
          今回は昔ながらのレトロなゲームに似たシューティングゲームをミニサイズにして再現します。<br>
          それではやっていきましょう
        </p>
      </section>

      <section class="centered-section">
        <h3 class="ther-title">2.HARDWARE DESIGN</h3>
        <h4 class="fort-title">～使用パーツ～</h4>
        <img class="part-img" src="img/product6_img/part.png" alt="">

        <h5 class="fifth-title">◇Arduinoをブレッドボードに接続</h5>
        <p class="overview-text">
          今回は私はArduino Unoボードを使用します。ボードをUSBケーブルでパソコンに接続し、電源を供給します。
        </p>
        <img class="part-img" src="img/product1_img/step1.png" alt="">

        <h4 class="fort-title">～左ボタン設置～</h4>
        <h5 class="fifth-title">◇Arduinoをブレッドボードに接続</h5>
        <p class="overview-text">
          Arduino Unoボードをブレッドボードの隣に配置します。<br>
          赤いジャンパーワイヤーを使用して、Arduinoの5Vピンをブレッドボードの正極電源レールに接続します。<br>
          黒いジャンパーワイヤーを使用して、ArduinoのGND（グランド）ピンをブレッドボードの負極電源レールに接続します。<br>
        </p>
        <h5 class="fifth-title">◇プッシュボタンをブレッドボードに配置</h5>
        <p class="overview-text">
          プッシュボタンをブレッドボードに挿入し、4本の足がそれぞれ異なる行に入るようにします。
        </p>
        <h5 class="fifth-title">◇抵抗を接続</h5>
        <p class="overview-text">
          抵抗の片方の足をプッシュボタンの片方の足に接続します。<br>
          抵抗のもう片方の足をブレッドボードの負極電源レールに接続します。<br>
        </p>
        <h5 class="fifth-title">◇プッシュボタンをArduinoに接続</h5>
        <p class="overview-text">
          ジャンパーワイヤーを使用して、プッシュボタンの片方の足（抵抗と接続されている足）をArduinoのデジタル入力ピン（例：ピン2）に接続します<br>
          別のジャンパーワイヤーを使用して、プッシュボタンの反対側の足をブレッドボードの正極電源レールに接続します。<br>
        </p>
        <img class="part-img" src="img/product6_img/hard/step1.png" alt="">

        <h4 class="fort-title">～右ボタン設置～</h4>
        <h5 class="fifth-title">◇LEDリングの電源接続</h5>
        <p class="overview-text">
          右のボタンも同じように設置しましょう<br>
        </p>
        <img class="part-img" src="img/product6_img/hard/step2.png" alt="">

        <h4 class="fort-title">～発射ボタン設置～</h4>
        <p class="overview-text">
          弾を発射するためのボタンを設置する
        </p>
        <img class="part-img" src="img/product6_img/hard/step3.png" alt="">

        <h4 class="fort-title">～ディスプレイ設置～</h4>
        <p class="overview-text">
          ゲームを描画するためのディスプレイを設置します。<br>
          ディスプレイのVCCピンをブレッドボードの正の電源レールに接続します。<br>
          ディスプレイのGNDピンをブレッドボードの負の電源レールに接続します。<br>
          ディスプレイのSCLピンをArduino UNOのA5ピンに接続します。<br>
          ディスプレイのSDAピンをArduino UNOのA4ピンに接続します。<br>
        </p>
        <img class="part-img" src="img/product6_img/hard/step4.png" alt="">

        <h5 class="fifth-title">◇回路の確認</h5>
        <ul class="overview-text">
          <li><span style="color: orange;">LEDの極性</span>: LEDにはアノード（正極）とカソード（負極）があり、極性が逆になっていると点灯しません。
            LEDの長い端子（アノード）が正しいピンに接続されているか確認してください。</li>
          <li><span style="color: orange;">抵抗の値と接続</span>: 抵抗が正しい値（220Ωなど）であり、正しい位置に接続されているか確認します。
            抵抗の値が間違っていると、LEDが壊れる可能性があります。</li>
          <li><span style="color: orange;">ジャンプワイヤーの接続</span>: ジャンパーワイヤーが正しいピンに接続され、
            しっかりと差し込まれているか確認してください。緩んでいると接触不良が発生します。</li>
          <li><span style="color: orange;">ショート回路の確認</span>: ブレッドボード上でピン同士が直接接触している部分がないか確認します。
            ショート回路が発生すると、Arduinoや他の部品が損傷する可能性があります。</li>
          <li><span style="color: orange;">Arduinoボードの接続</span>: Arduinoボードが正しく接続され、電源が入っているか確認してください。
            接続が緩んでいると正常に動作しません。</li>
        </ul>

      </section>

      <!--Arduino-->
      <section class="centered-section">
        <h3 class="ther-title">3.ARDUINO CODING</h3>
        <h4 class="fort-title">～コード内容～</h4>
        <h5 class="fifth-title">◇ヘッダーファイルのインクルード</h5>
        <p class="overview-text">
          <span class="code-block">Wire.h</span>, <span class="code-block">SPI.h</span>：通信ライブラリ<br>
          <span class="code-block">Adafruit_GFX.h</span>, <span
            class="code-block">Adafruit_SSD1306.h</span>：OLEDディスプレイ用ライブラリ<br>
        </p>
        <div class="code-container">
          <span class="file-name">Shooting-Game.ino</span>
          <pre><code>
#include &lt;Wire.h&gt;
#include &lt;SPI.h&gt;
#include &lt;Adafruit_GFX.h&gt;
#include &lt;Adafruit_SSD1306.h&gt;
          </code></pre>
        </div>

        <h5 class="fifth-title">◇ディスプレイ設定</h5>
        <p class="overview-text">
          <span class="code-block">SCREEN_WIDTH</span>：ディスプレイの横幅ピクセル数<br>
          <span class="code-block">SCREEN_HEIGHT</span>：ディスプレイの縦幅ピクセル数<br>
          <span class="code-block">OLED_RESET</span>：ディスプレイのリセットピン<br>
          <span class="code-block">SCREEN_ADDRESS</span>：ディスプレイのI2Cアドレス<br>
          <span class="code-block">display</span>：Adafruit SSD1306ディスプレイオブジェクト<br>
        </p>
        <div class="code-container">
          <span class="file-name">Shooting-Game.ino</span>
          <pre><code>
#define SCREEN_WIDTH 128
#define SCREEN_HEIGHT 64
#define OLED_RESET -1
#define SCREEN_ADDRESS 0x3C
Adafruit_SSD1306 display(SCREEN_WIDTH, SCREEN_HEIGHT, &Wire, OLED_RESET);
          </code></pre>
        </div>

        <h5 class="fifth-title">◇ボタンとゲームの設定</h5>
        <p class="overview-text">
          <span class="code-block">RED_BUTTON</span>, <span class="code-block">BLUE_BUTTON</span>, <span
            class="code-block">SHOT_BUTTON</span>：ボタンのピン番号<br>
          <span class="code-block">Ball</span>, <span class="code-block">Enemy</span>：構造体はボールと敵の位置とアクティブ状態を管理<br>
          <span class="code-block">MAX_BALLS</span>, <span class="code-block">MAX_ENEMIES</span>：ボールと敵の最大数<br>
          <span class="code-block">balls</span>, <span class="code-block">enemies</span>：ボールと敵の配列<br>
          <span class="code-block">lastEnemySpawnTime</span>, <span
            class="code-block">enemySpawnInterval</span>：敵の生成に関するタイミング<br>
          <span class="code-block">enemySpeed</span>, <span class="code-block">score</span>, <span
            class="code-block">lives</span>：ゲームの進行に関する変数<br>
          <span class="code-block">gameOver</span>, <span class="code-block">gameClear</span>, <span
            class="code-block">gameStarted</span>, <span class="code-block">difficulty</span>：ゲームの状態と難易度<br>
        </p>
        <div class="code-container">
          <span class="file-name">Shooting-Game.ino</span>
          <pre><code>
int RED_BUTTON = 4;
int BLUE_BUTTON = 3;
int SHOT_BUTTON = 2;

struct Ball { int x; int y; bool active; };
struct Enemy { int x; int y; bool active; };

#define MAX_BALLS 5
#define MAX_ENEMIES 3

Ball balls[MAX_BALLS];
Enemy enemies[MAX_ENEMIES];

unsigned long lastEnemySpawnTime = 0;
unsigned long enemySpawnInterval = 2000; // 敵の生成間隔 (ミリ秒)
int enemySpeed = 3;
int score = 0;
int lives = 3; // プレイヤーのライフ
bool gameOver = false;
bool gameClear = false;
bool gameStarted = false;
int difficulty = 0; // 0: Easy, 1: Normal, 2: Hard
          </code></pre>
        </div>

        <h5 class="fifth-title">◇初期化関数</h5>
        <p class="overview-text">
          <span class="code-block">Serial.begin(115200)</span>：シリアル通信の初期化<br>
          <span class="code-block">display.begin()</span>：ディスプレイの初期化<br>
          <span class="code-block">pinMode()</span>：ボタンピンの入力設定<br>
          <span class="code-block">display.clearDisplay()</span>：ディスプレイのクリア<br>
        </p>
        <div class="code-container">
          <span class="file-name">Shooting-Game.ino</span>
          <pre><code>
void setup() {
  Serial.begin(115200);
  if (!display.begin(SSD1306_SWITCHCAPVCC, SCREEN_ADDRESS)) {
      Serial.println(F("SSD1306 disconnection"));
      for (;;);
  }
  pinMode(RED_BUTTON, INPUT_PULLUP);
  pinMode(BLUE_BUTTON, INPUT_PULLUP);
  pinMode(SHOT_BUTTON, INPUT_PULLUP);
  display.clearDisplay(); //初期化
}          
          </code></pre>
        </div>

        <h5 class="fifth-title">◇メインループ</h5>
        <p class="overview-text">
          <span class="code-block">x</span>, <span class="code-block">y</span>：プレイヤーの位置<br>
          <span class="code-block">if (!gameStarted) displayMenu(); return;</span>：ゲームが始まっていない場合、メニューを表示<br>
          <span class="code-block">if (gameOver) drawGameOver(); return;</span>：ゲームオーバー時に画面を更新<br>
          <span class="code-block">if (gameClear) drawGameClear(); return;</span>：ゲームクリア時に画面を更新<br>
          <span class="code-block">digitalRead()</span>：ボタンの状態を読み取り、プレイヤーの移動とボール生成を行う<br>
          <span class="code-block">millis()</span>：時間経過に基づいて敵を生成<br>
          <span class="code-block">moveBalls()</span>, <span class="code-block">moveEnemies()</span>,
          <span class="code-block">checkCollisions()</span>, <span
            class="code-block">draw()</span>：ボールと敵の移動、衝突判定、描画を行う<br>
        </p>
        <div class="code-container">
          <span class="file-name">Repulsor-Beam.ino</span>
          <pre><code>
static int x = SCREEN_WIDTH / 2;
static int y = 64;

void loop() {
  if (!gameStarted) {
    displayMenu();
    return;
  }
  if (gameOver) {
    drawGameOver();
    return;
  }
  if (gameClear) {
    drawGameClear();
    return;
  }
  if (digitalRead(RED_BUTTON) == HIGH)
    x = x - 5;
  else if (digitalRead(BLUE_BUTTON) == HIGH)
    x = x + 5;
  if (digitalRead(SHOT_BUTTON) == HIGH) {
    for (int i = 0; i < MAX_BALLS; i++) {
      if (!balls[i].active) {
        balls[i] = {x, y - 10, true}; // ボールを生成
        break;
      }
    }
  }
  if (millis() - lastEnemySpawnTime > enemySpawnInterval) {
    for (int i = 0; i < MAX_ENEMIES; i++) {
      if (!enemies[i].active) {
        enemies[i] = {random(0, SCREEN_WIDTH), 0, true}; // 敵を生成
        lastEnemySpawnTime = millis();
        break;
      }
    }
  }
  moveBalls();
  moveEnemies();
  checkCollisions();
  draw();
}                 
          </code></pre>
        </div>

        <h5 class="fifth-title">◇ボールの移動</h5>
        <p class="overview-text">
          <span class="code-block">balls[i].y -= 5</span>：ボールを上に移動<br>
          <span class="code-block">if (balls[i].y < 0) balls[i].active = false;</span>：画面外に出たボールを非アクティブにする
        </p>
        <div class="code-container">
          <span class="file-name">Repulsor-Beam.ino</span>
          <pre><code>
void moveBalls() {
  for (int i = 0; i < MAX_BALLS; i++) {
    if (balls[i].active) {
      balls[i].y -= 5;
      if (balls[i].y < 0) {
        balls[i].active = false;
      }
    }
  }
}          
          </code></pre>
        </div>

        <h5 class="fifth-title">◇敵の移動</h5>
        <p class="overview-text">
          <span class="code-block">enemies[i].y += enemySpeed</span>：敵を下に移動<br>
          <span class="code-block">if (enemies[i].y > SCREEN_HEIGHT) enemies[i].active = false;</span>：画面外に出た敵を非アクティブにする<br>
          <span class="code-block">lives--</span>：ライフを減らす<br>
          <span class="code-block">if (lives <= 0) gameOver = true;</span>：ライフが0になったらゲームオーバー
        </p>
        <div class="code-container">
          <span class="file-name">Repulsor-Beam.ino</span>
          <pre><code>
void moveEnemies() {
  for (int i = 0; i < MAX_ENEMIES; i++) {
    if (enemies[i].active) {
      enemies[i].y += enemySpeed;
      if (enemies[i].y > SCREEN_HEIGHT) {
        enemies[i].active = false;
        lives--;
        if (lives <= 0) {
          gameOver = true;
        }
      }
    }
  }
}              
          </code></pre>
        </div>

        <h5 class="fifth-title">◇衝突判定</h5>
        <p class="overview-text">
          <span class="code-block">sqrt(dx * dx + dy * dy)</span>：ボールと敵の距離を計算<br>
          <span class="code-block">if (distance < 10)</span>：距離が10未満の場合、ボールと敵を非アクティブにする<br>
          <span class="code-block">score += 10</span>：スコアを10ポイント追加<br>
          <span class="code-block">if (score >= 300) gameClear = true; gameOver = false;</span>：スコアが300以上になったらゲームクリア<br>
        </p>
        <div class="code-container">
          <span class="file-name">Repulsor-Beam.ino</span>
          <pre><code>
void checkCollisions() {
  for (int i = 0; i < MAX_BALLS; i++) {
    if (balls[i].active) {
      for (int j = 0; j < MAX_ENEMIES; j++) {
        if (enemies[j].active) {
          int dx = balls[i].x - enemies[j].x;
          int dy = balls[i].y - enemies[j].y;
          int distance = sqrt(dx * dx + dy * dy);
          if (distance < 10) {
            balls[i].active = false;
            enemies[j].active = false;
            score += 10;
            if (score >= 300) {
              gameClear = true;
              gameOver = false;
            }
          }
        }
      }
    }
  }
}                  
          </code></pre>
        </div>

        <h5 class="fifth-title">◇メニューの表示</h5>
        <p class="overview-text">
          <span class="code-block">digitalRead(RED_BUTTON) == HIGH</span>：REDボタンが押されたときの処理（Easyモード）<br>
          <span class="code-block">digitalRead(BLUE_BUTTON) == HIGH</span>：BLUEボタンが押されたときの処理（Normalモード）<br>
          <span class="code-block">digitalRead(SHOT_BUTTON) == HIGH</span>：SHOTボタンが押されたときの処理（Hardモード）<br>
          <span class="code-block">enemySpeed</span>：敵の速度<br>
          <span class="code-block">lives</span>：プレイヤーのライフ<br>
          <span class="code-block">gameStarted</span>：ゲーム開始フラグ<br>
        </p>
        <div class="code-container">
          <span class="file-name">Repulsor-Beam.ino</span>
          <pre><code>
void displayMenu() {
  display.clearDisplay();
  display.setCursor(0, 0);
  display.setTextSize(1);
  display.setTextColor(WHITE);
  display.print("Select Difficulty:");
  display.setCursor(0, 10);
  display.print("RED: Easy");
  display.setCursor(0, 20);
  display.print("BLUE: Normal");
  display.setCursor(0, 30);
  display.print("SHOT: Hard");
  display.display();

  if (digitalRead(RED_BUTTON) == HIGH) {
    difficulty = 0;
    enemySpeed = 3;
    lives = 3;
    gameStarted = true;
  } else if (digitalRead(BLUE_BUTTON) == HIGH) {
    difficulty = 1;
    enemySpeed = 10;
    lives = 3;
    gameStarted = true;
  } else if (digitalRead(SHOT_BUTTON) == HIGH) {
    difficulty = 2;
    enemySpeed = 10;
    lives = 1;
    gameStarted = true;
  }
}        
          </code></pre>
        </div>

        <h5 class="fifth-title">◇メニューの表示</h5>
        <p class="overview-text">
          <span class="code-block">display.clearDisplay()</span>：ディスプレイのクリア<br>
          <span class="code-block">display.print("Score: "); display.print(score);</span>：スコアの表示<br>
          <span class="code-block">display.print("LIFE: "); display.print(lives);</span>：ライフの表示<br>
          <span class="code-block">display.drawCircle(x, y, 10, WHITE);</span>：プレイヤーの描画<br>
          <span class="code-block">display.fillCircle(balls[i].x, balls[i].y, 2, WHITE);</span>：ボールの描画<br>
          <span class="code-block">display.fillRect(enemies[i].x, enemies[i].y, 8, 8, WHITE);</span>：敵の描画<br>
          <span class="code-block">display.display();</span>：ディスプレイの更新<br>
        </p>
        <div class="code-container">
          <span class="file-name">Repulsor-Beam.ino</span>
          <pre><code>
void draw() {
  display.clearDisplay();
  display.setCursor(0, 0);
  display.setTextSize(1);
  display.setTextColor(WHITE);
  display.print("Score: ");
  display.print(score); // スコアを表示
  display.setCursor(SCREEN_WIDTH / 2, 0);
  display.print(" LIFE: ");
  display.print(lives); // ライフを表示
  display.drawCircle(x, y, 10, WHITE); // プレイヤーを描画
  for (int i = 0; i < MAX_BALLS; i++) {
    if (balls[i].active) {
      display.fillCircle(balls[i].x, balls[i].y, 2, WHITE); // ボールを描画
    }
  }
  for (int i = 0; i < MAX_ENEMIES; i++) {
    if (enemies[i].active) {
      display.fillRect(enemies[i].x, enemies[i].y, 8, 8, WHITE); // 敵を描画
    }
  }
  display.display();
  delay(100);
}          
          </code></pre>
        </div>
        <h5 class="fifth-title">◇ゲームオーバーの表示</h5>
        <p class="overview-text">
          <span class="code-block">display.print("Game Over");</span>：ゲームオーバーのメッセージを表示<br>
        </p>
        <div class="code-container">
          <span class="file-name">Repulsor-Beam.ino</span>
          <pre><code>
void drawGameOver() {
  display.clearDisplay();
  display.setCursor(0, SCREEN_HEIGHT / 2);
  display.setTextSize(2);
  display.setTextColor(WHITE);
  display.print("Game Over"); // ゲームオーバーを表示
  display.display();
}          
          </code></pre>
        </div>

        <h5 class="fifth-title">◇ゲームクリアの表示</h5>
        <p class="overview-text">
          <span class="code-block">display.print("Game Clear");</span>：ゲームクリアのメッセージを表示<br>
        </p>
        <div class="code-container">
          <span class="file-name">Repulsor-Beam.ino</span>
          <pre><code>
void drawGameClear() {
  display.clearDisplay();
  display.setCursor(0, SCREEN_HEIGHT / 2);
  display.setTextSize(2);
  display.setTextColor(WHITE);
  display.print("Game Clear"); // ゲームクリアを表示
  display.display();
}          
          </code></pre>
        </div>

        <h5 class="fifth-title">◇完成版コード</h5>
        <div class="code-container">
          <details>
            <summary><strong><span class="file-name-summa">Repulsor-Beam.ino</span></strong></summary>
            <pre><code>
#include &lt;Wire.h&gt;
#include &lt;SPI.h&gt;
#include &lt;Adafruit_GFX.h&gt;
#include &lt;Adafruit_SSD1306.h&gt;

#define SCREEN_WIDTH 128
#define SCREEN_HEIGHT 64
#define OLED_RESET -1
#define SCREEN_ADDRESS 0x3C
Adafruit_SSD1306 display(SCREEN_WIDTH, SCREEN_HEIGHT, &Wire, OLED_RESET);

int RED_BUTTON = 4;
int BLUE_BUTTON = 3;
int SHOT_BUTTON = 2;

struct Ball { int x; int y; bool active; };
struct Enemy { int x; int y; bool active; };

#define MAX_BALLS 5
#define MAX_ENEMIES 3

Ball balls[MAX_BALLS];
Enemy enemies[MAX_ENEMIES];

unsigned long lastEnemySpawnTime = 0;
unsigned long enemySpawnInterval = 2000; // 敵の生成間隔 (ミリ秒)
int enemySpeed = 3;
int score = 0;
int lives = 3; // プレイヤーのライフ
bool gameOver = false;
bool gameClear = false;
bool gameStarted = false;
int difficulty = 0; // 0: Easy, 1: Normal, 2: Hard

void setup() {
  Serial.begin(115200);
  if (!display.begin(SSD1306_SWITCHCAPVCC, SCREEN_ADDRESS)) {
    Serial.println(F("SSD1306 disconnection"));
    for (;;);
  }
  pinMode(RED_BUTTON, INPUT_PULLUP);
  pinMode(BLUE_BUTTON, INPUT_PULLUP);
  pinMode(SHOT_BUTTON, INPUT_PULLUP);
  display.clearDisplay(); //初期化
}

static int x = SCREEN_WIDTH / 2;
static int y = 64;

void loop() {
  if (!gameStarted) {
    displayMenu();
    return;
  }
  if (gameOver) {
    drawGameOver();
    return;
  }
  if (gameClear) {
    drawGameClear();
    return;
  }
  if (digitalRead(RED_BUTTON) == HIGH) // ボタンが押されたとき
    x = x - 5;
  else if (digitalRead(BLUE_BUTTON) == HIGH)
    x = x + 5;
  if (digitalRead(SHOT_BUTTON) == HIGH) {
    for (int i = 0; i < MAX_BALLS; i++) {
      if (!balls[i].active) {
        balls[i] = {x, y - 10, true}; // ボールを生成
        break;
      }
    }
  }
  if (millis() - lastEnemySpawnTime > enemySpawnInterval) {
    for (int i = 0; i < MAX_ENEMIES; i++) {
      if (!enemies[i].active) {
        enemies[i] = {random(0, SCREEN_WIDTH), 0, true}; // 敵を生成
        lastEnemySpawnTime = millis();
        break;
      }
    }
  }
  moveBalls();
  moveEnemies();
  checkCollisions();
  draw();
}

void moveBalls() {
  for (int i = 0; i < MAX_BALLS; i++) {
    if (balls[i].active) {
      balls[i].y -= 5; // ボールを上に移動
      if (balls[i].y < 0) {
        balls[i].active = false; // 画面外に出たら非アクティブにする
      }
    }
  }
}

void moveEnemies() {
  for (int i = 0; i < MAX_ENEMIES; i++) {
    if (enemies[i].active) {
      enemies[i].y += enemySpeed; // 敵を下に移動
      if (enemies[i].y > SCREEN_HEIGHT) {
        enemies[i].active = false; // 画面外に出たら非アクティブにする
        lives--; // ライフを減らす
        if (lives <= 0) {
          gameOver = true;
        }
      }
    }
  }
}

void checkCollisions() {
  for (int i = 0; i < MAX_BALLS; i++) {
    if (balls[i].active) {
      for (int j = 0; j < MAX_ENEMIES; j++) {
        if (enemies[j].active) {
          // 球と敵の当たり判定
          int dx = balls[i].x - enemies[j].x;
          int dy = balls[i].y - enemies[j].y;
          int distance = sqrt(dx * dx + dy * dy);
          if (distance < 10) { // 判定のための距離
            balls[i].active = false; // 球を非アクティブにする
            enemies[j].active = false; // 敵を非アクティブにする
            score += 10; // スコアに10ポイント追加
            if (score >= 300) {
              gameClear = true;
              gameOver = false; // ゲームオーバーのフラグをリセット
            }
          }
        }
      }
    }
  }
}

void displayMenu() {
  display.clearDisplay();
  display.setCursor(0, 0);
  display.setTextSize(1);
  display.setTextColor(WHITE);
  display.print("Select Difficulty:");
  display.setCursor(0, 10);
  display.print("RED: Easy");
  display.setCursor(0, 20);
  display.print("BLUE: Normal");
  display.setCursor(0, 30);
  display.print("SHOT: Hard");
  display.display();

  if (digitalRead(RED_BUTTON) == HIGH) {
    difficulty = 0;
    enemySpeed = 3;
    lives = 3;
    gameStarted = true;
  } else if (digitalRead(BLUE_BUTTON) == HIGH) {
    difficulty = 1;
    enemySpeed = 10;
    lives = 3;
    gameStarted = true;
  } else if (digitalRead(SHOT_BUTTON) == HIGH) {
    difficulty = 2;
    enemySpeed = 10;
    lives = 1;
    gameStarted = true;
  }
}

void draw() {
  display.clearDisplay();
  display.setCursor(0, 0);
  display.setTextSize(1);
  display.setTextColor(WHITE);
  display.print("Score: ");
  display.print(score); // スコアを表示
  display.setCursor(SCREEN_WIDTH/2, 0);
  display.print(" LIFE: ");
  display.print(lives); // ライフを表示
  display.drawCircle(x, y, 10, WHITE); // プレイヤーを描画
  for (int i = 0; i < MAX_BALLS; i++) {
    if (balls[i].active) {
      display.fillCircle(balls[i].x, balls[i].y, 2, WHITE); // ボールを描画
    }
  }
  for (int i = 0; i < MAX_ENEMIES; i++) {
    if (enemies[i].active) {
      display.fillRect(enemies[i].x, enemies[i].y, 8, 8, WHITE); // 敵を描画
    }
  }
  display.display();
  delay(100);
}

void drawGameOver() {
  display.clearDisplay();
  display.setCursor(0, SCREEN_HEIGHT / 2);
  display.setTextSize(2);
  display.setTextColor(WHITE);
  display.print("Game Over"); // ゲームオーバーを表示
  display.display();
}

void drawGameClear() {
  display.clearDisplay();
  display.setCursor(0, SCREEN_HEIGHT / 2);
  display.setTextSize(2);
  display.setTextColor(WHITE);
  display.print("Game Clear"); // ゲームクリアを表示
  display.display();
}                
            </code></pre>
          </details>

        </div>

      </section>

      <section class="centered-section">
        <h3 class="ther-title">5.EXECUTION</h3>
        <h4 class="fort-title">～ゲーム起動～</h4>
        <h5 class="fifth-title">◇コンパイル</h5>
        <p class="overview-text">
          Arduino IDEに書いたプログラムをArduinoにコンパイルしましょう。
        </p>
        <h5 class="fifth-title">◇メニュー画面</h5>
        <p class="overview-text">
          コンパイルすると以下のようなメニュー画面が出力出来たら成功です。赤ボタンを押すとイージーモードになります
          各ボタンを押すとゲーム難易度を選択することができます。
        </p>
        <img class="flet-gui-img" src="img/product6_img/soft/menu.png" alt="">

        <h5 class="fifth-title">◇ゲームスタート</h5>
        <p class="overview-text">
          ゲームをスタートさせると、このようにスコア、ライフ、プレイヤー、敵と描画されます。
        </p>
        <img class="flet-gui-img" src="img/product6_img/soft/game-start.png" alt="">

        <h5 class="fifth-title">◇ショット</h5>
        <p class="overview-text">
          小さい黒色のボタンを押すとこのように白い弾を打つことができます。
        </p>
        <img class="flet-gui-img" src="img/product6_img/soft/shoot.png" alt="">
        <h5 class="fifth-title">◇ゲームオーバー</h5>
        <p class="overview-text">
          ライフが0になるとこのように「game over」と表示されます
        </p>
        <img class="flet-gui-img" src="img/product6_img/soft/game-over.png" alt="">

        <h5 class="fifth-title">◇ゲームクリア</h5>
        <p class="overview-text">
          スコアが300点以上になると「game clear」と表示されます
        </p>
        <img class="flet-gui-img" src="img/product6_img/soft/game-over.png" alt="">

        <h5 class="fifth-title">◇リスタート</h5>
        <p class="overview-text">
          もう一度開始するには、USBを一度抜き差しするまたは、Arduino本体についている赤いボタンを押すとプログラムが再実行されます。
        </p>
        <img class="flet-gui-img" src="img/product6_img/soft/menu.png" alt="">

      </section>

      <section class="centered-section">
        <h3 class="ther-title">6.END</h3>
        <h5 class="end-title">楽しめましたでしょうか<br>これでこの作品は終わりです<br>お疲れさまでした。</h5>

      </section>
    </section>


    <section id="contact">
      <h2 class="sec-title">CONTACT</h2>
      <div class="content">
        <div class="contact-info">
          <p>このサイトはRabyの作った自己満サイトです</p>
          <p>
            このサイトから学べることは少ないと思います。しかし、新しい発見の手助けと
            なればと思います。新しい視点を得たり、興味を持つテーマを見つけたりするこ
            とができるでしょう。是非、お楽しみいただければ幸いです。
          </p>
          <p>
            また、このようなことをやってほしいという要望があれば、ぜひお知らせくださ
            い。私たちは皆さまのご意見を大切にし、より良いサービスを提供できるよう努
            めております。どんな小さなことでも構いませんので、皆さまのアイデアをお待
            ちしております。
          </p>
        </div>

        <div class="contact-form">
          <form action="#">
            <dl>
              <dt><label for="name">Name:</label></dt>
              <dd><input type="text" id="name" name="your-name"></dd>
              <dt><label for="email">Mail:</label></dt>
              <dd><input type="email" id="email" name="your-email"></dd>
              <dt><label for="message">Message:</label></dt>
              <dd><textarea id="message" name="your-message"></textarea></dd>
            </dl>
            <div class="button"><input type="submit" value="SEND"></div>
          </form>
        </div>
      </div>
    </section>

  </main>

  <footer id="footer">
    <p>&copy; Raby Lab</p>
  </footer>
</body>

</html>